# 环境安装

## 安装 Pytorch
本节中，我们将演示如何用 PyTorch 准备一个环境。

YOLOv6 支持在 Linux，Windows 和 macOS 上运行。它需要 Python 3.8 以上 和 PyTorch 1.8 以上。

```{note}
如果你对 PyTorch 有经验并且已经安装了它，你可以直接跳转到[下一小节](#安装YOLOv6)。否则，你可以按照下述步骤进行准备
```

**步骤 0.** 从 [官方网站](https://docs.conda.io/en/latest/miniconda.html) 下载并安装 Miniconda。

**步骤 1.** 创建并激活一个 conda 环境。

```shell
conda create -n yolov6 python=3.8 -y
conda activate yolov6
```

**步骤 2.** 基于 [PyTorch 官方说明](https://pytorch.org/get-started/locally/) 安装 PyTorch。

这里以安装 PyTorch1.8.0 为例：(注意选择与您的cuda匹配的版本)

Conda

OSX系统：
```
# conda
conda install pytorch==1.8.0 torchvision==0.9.0 torchaudio==0.8.0 -c pytorch
```
Linux and Windows系统：
```
# CUDA 10.2
conda install pytorch==1.8.0 torchvision==0.9.0 torchaudio==0.8.0 cudatoolkit=10.2 -c pytorch

# CUDA 11.1
conda install pytorch==1.8.0 torchvision==0.9.0 torchaudio==0.8.0 cudatoolkit=11.1 -c pytorch -c conda-forge

# CPU Only
conda install pytorch==1.8.0 torchvision==0.9.0 torchaudio==0.8.0 cpuonly -c pytorch

```

Wheel

OSX系统：

```
pip install torch==1.8.0 torchvision==0.9.0 torchaudio==0.8.0
```

Linux and Windows系统：

```
# CUDA 11.1
pip install torch==1.8.0+cu111 torchvision==0.9.0+cu111 torchaudio==0.8.0 -f https://download.pytorch.org/whl/torch_stable.html

# CUDA 10.2
pip install torch==1.8.0 torchvision==0.9.0 torchaudio==0.8.0

# CPU only
pip install torch==1.8.0+cpu torchvision==0.9.0+cpu torchaudio==0.8.0 -f https://download.pytorch.org/whl/torch_stable.html

```

## 安装 YOLOv6

```shell
git clone https://github.com/meituan/YOLOv6
cd YOLOv6
pip install -r requirements.txt
```

## 验证安装

为了验证 YOLOv6 是否安装正确，我们提供了一些示例代码来执行模型推理。

**步骤 1.** 下载模型权重文件。

```
pip install wget
wget https://github.com/meituan/YOLOv6/releases/download/0.2.0/yolov6n.pt
mkdir weights
mv yolov6n.pt weights/yolov6n.pt
```

**步骤 2.** 推理验证


```shell
python tools/infer.py --weights weights/yolov6n.pt --source data/images/

# 可选参数
# --device 0         *使用的计算资源，包括cuda, cpu等，默认为0
# --name exp         *用于指定source图像推理结果可视化的保存文件夹                       
# --view-img          *使用该参数表示在屏幕上显示检测结果，默认为False
# --conf_thres 0.4    *置信度阈值，默认为0.4
```

运行结束后，在 `runs/inference/exp` 文件夹中可以看到检测结果图像，图像中包含有网络预测的检测框。

支持输入类型包括

- 单张图片, 支持 `bmp`, `jpg`, `jpeg`, `png`, `tif`, `tiff`, `dng`, `webp`, `mpo`。
- 文件目录，会遍历文件目录下所有图片文件，并输出对应结果。
- 单个视频，支持`mp4`, `mov`, `avi`, `mkv`。

